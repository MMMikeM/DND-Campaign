---
import Layout from '../../../layouts/Layout.astro';
import NpcForm from '../../../components/NpcForm.astro';
import { db } from '../../../lib/db';
import { npcs } from '@tome-keeper/shared';
import { eq } from 'drizzle-orm';

const { id } = Astro.params;
const npc = await db.select().from(npcs).where(eq(npcs.id, Number(id))).get();

if (!npc) {
	return Astro.redirect('/npcs');
}
---

<Layout title="Edit NPC">
	<div class="max-w-4xl mx-auto">
		<h1 class="text-4xl font-bold mb-8">Edit NPC: {npc.name}</h1>
		<NpcForm
			npc={npc}
			action={`/api/npcs/${id}`}
			method="PUT"
		/>
	</div>
</Layout> 