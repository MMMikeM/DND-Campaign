---
import Layout from '../../../layouts/Layout.astro';
import FactionForm from '../../../components/FactionForm.astro';
import { db } from '../../../lib/db';
import { factions } from '@tome-keeper/shared';
import { eq } from 'drizzle-orm';

export const prerender = false;

const { id } = Astro.params;
const faction = await db.select().from(factions).where(eq(factions.id, Number(id))).get();

if (!faction) {
	return Astro.redirect('/factions');
}
---

<Layout title="Edit Faction">
	<div class="max-w-4xl mx-auto">
		<h1 class="text-4xl font-bold mb-8">Edit Faction: {faction.name}</h1>
		<FactionForm
			faction={faction}
			action={`/api/factions/${id}`}
			method="PUT"
		/>
	</div>
</Layout> 